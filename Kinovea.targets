<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  
  <ItemGroup>
    <SVGObsRefsFiles Include="..\Tools\svg\*.svg" />
    <XSLTFiles Include="..\Tools\XML\Kva to Spreadsheets\*.xsl" />
    <XSLTFiles Include="..\Tools\XML\Kva to Kva\*.xsl" />
    <XSLTFiles Include="..\Tools\XML\Preferences\*.xsl" />
    <DrawingToolsFiles Include="..\Tools\DrawingTools\**\*.xml" />
  </ItemGroup>

  <PropertyGroup>
    <BuildDependsOn>
      $(BuildDependsOn);
      CopyNativeDependencies;
      CopySVGObsRefs;
      CopyHelp;
      CopyXSLT;
      CopyDrawingTools;
    </BuildDependsOn>
  </PropertyGroup>

  <Target Name="CopyNativeDependencies">
    <Message Text="Copying native dependencies."/>
    
    <Copy SourceFiles="..\Refs\FFmpeg\bin\avcodec-55.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\avdevice-55.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\avfilter-4.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\avformat-55.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\avutil-52.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\postproc-52.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\swresample-0.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\FFmpeg\bin\swscale-2.dll" DestinationFolder="$(TargetDir)"/>
        
    <Copy SourceFiles="..\Refs\Microsoft.VC90.CRT\msvcm90.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\Microsoft.VC90.CRT\msvcp90.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\Microsoft.VC90.CRT\msvcr90.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\Microsoft.VC90.CRT\Microsoft.VC90.CRT.manifest" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\Microsoft.VC90.OpenMP\vcomp90.dll" DestinationFolder="$(TargetDir)"/>
    <Copy SourceFiles="..\Refs\Microsoft.VC90.OpenMP\Microsoft.VC90.OpenMP.manifest" DestinationFolder="$(TargetDir)"/>
    
    <Copy SourceFiles="..\Refs\TurboJpeg\turbojpeg.dll" DestinationFolder="$(TargetDir)"/>

    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\cvextern.dll" DestinationFolder="$(TargetDir)\x86"/>
    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\opencv_core2410.dll" DestinationFolder="$(TargetDir)\x86"/>
    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\opencv_calib3d2410.dll" DestinationFolder="$(TargetDir)\x86"/>
    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\opencv_features2d2410.dll" DestinationFolder="$(TargetDir)\x86"/>
    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\opencv_imgproc2410.dll" DestinationFolder="$(TargetDir)\x86"/>
    <Copy SourceFiles="..\Refs\OpenCV\2.4.10\x86\OpenCL.dll" DestinationFolder="$(TargetDir)\x86"/>
  </Target>

  <Target Name="CopySVGObsRefs">
    <Message Text="Copying SVG observation references."/>
    <RemoveDir Directories="$(TargetDir)guides" />
    <MakeDir Directories="$(TargetDir)guides" Condition="!Exists('$(TargetDir)guides')" />
    <Copy SourceFiles="@(SVGObsRefsFiles)" DestinationFolder="$(TargetDir)guides"/>
  </Target>
    
  <Target Name="CopyHelp">
    <Message Text="Copying Help index."/>
    <Copy SourceFiles="..\Installer\OtherFiles\HelpIndex.xml" DestinationFolder="$(TargetDir)"/>
  </Target>
  
  <Target Name="CopyXSLT">
    <Message Text="Copying XSLT sheets."/>
    <RemoveDir Directories="$(TargetDir)xslt" />
    <MakeDir Directories="$(TargetDir)xslt" Condition="!Exists('$(TargetDir)xslt')" />
    <Copy SourceFiles="@(XSLTFiles)" DestinationFolder="$(TargetDir)xslt"/>
  </Target>

  <Target Name="CopyDrawingTools">
    <Message Text="Copying drawing tools."/>
    <RemoveDir Directories="$(TargetDir)DrawingTools" />
    <MakeDir Directories="$(TargetDir)DrawingTools" Condition="!Exists('$(TargetDir)DrawingTools')" />
    <Copy SourceFiles="@(DrawingToolsFiles)" DestinationFolder="$(TargetDir)DrawingTools\%(RecursiveDir)"/>
  </Target>

</Project>
